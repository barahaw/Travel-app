var Client;(()=>{"use strict";var e={d:(t,o)=>{for(var a in o)e.o(o,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:o[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{handleSubmit:()=>l});let o={};const a=document.querySelector("#user-date"),n="043c1cdc1d9a4d6aa5af1e0f5b8c6797",c="15718385-e6469b99add168316507ab087",r="https://pixabay.com/api/?key=",s="&image_type=photo&pretty=true&category=places";const l=async e=>{(async e=>{console.log("geonames API begins!"),await fetch("http://api.geonames.org/postalCodeSearchJSON?placename="+e+"&maxRows=10&username=nohambeldin").then((e=>e.json())).then((e=>{const t={lat:e.postalCodes[0].lat,lng:e.postalCodes[0].lng,countryCode:e.postalCodes[0].countryCode,city:e.postalCodes[0].placeName,country:e.postalCodes[0].countryName};o.coords=t})).catch((e=>{console.log(e)})),console.log(o)})(e).then((()=>(async e=>{console.log("weatherbitAPI API Begins!");const t=(new Date(e).getTime()-(new Date).getTime())/864e5;console.log(t);const a=o.coords.lat,c=o.coords.lng;let r=t>7?"https://api.weatherbit.io/v2.0/forecast/daily?lat="+a+"&lon="+c+"&key="+n:"https://api.weatherbit.io/v2.0/current?lat="+a+"&lon="+c+"&key="+n;console.log(r),(await fetch("http://localhost:3000/forecast",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:r})})).json().then((e=>{o.forecastData=e,o.dates=t})).catch((e=>{console.log(e)})),console.log(o.dates)})(a))).then((()=>(async e=>{console.log("Pixabay API Begins"),e=e.replace(/\s/g,"+");const t=o.coords.country,a=r+c+"&q="+e+s,n=r+c+"&q="+e+","+t+s,l=await fetch(a);let i=await l.json();if(i.totalHits>0){const e={src:i.hits[0].largeImageURL};o.pic=e}else{const e=await fetch(n),t={src:(await e.json()).hits[0].webformatURL};o.pic=t}console.log(o)})(e))).then((()=>function(e){console.log("updationg UI!!!!");const t=e.dates,o=1===t?"day":"days",a=e.pic?e.pic.src:"",n=e.forecastData?Math.round(e.forecastData.daily_tempHigh):"",c=e.forecastData?Math.round(e.forecastData.daily_tempLow):"",r=e.forecastData?Math.round(e.forecastData.current_temp):"",s=e.forecastData?e.forecastData.daily_icon:"",l=e.forecastData?e.forecastData.current_icon:"";console.log(n),document.querySelector(".Res-container").style.display="flex",null==e.coords.country?document.querySelector(".country").innerHTML=e.coords.city:document.querySelector(".country").innerHTML=e.coords.city+", "+e.coords.country;const i=document.querySelector("#end-date").value,d=((e,t)=>{const o=new Date(e),a=new Date(t);return Math.floor((Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(o.getFullYear(),o.getMonth(),o.getDate()))/864e5)})(document.querySelector("#start-date").value,i);document.querySelector(".length").innerHTML=d,document.querySelector(".ldays").innerHTML=d>1?" days":"day",document.querySelector(".days").innerHTML=t+" "+o+" ",document.querySelector(".img").src=a,t>7?(document.querySelector(".temps").innerHTML="Temperature is: "+r+"&#8451;",document.querySelector(".d-icon").src="/weather-icons/"+s+".png",document.querySelector(".c-icon").style.display="none"):(document.querySelector(".temps").innerHTML="High- "+n+"&#8451;, Low- "+c+"&#8451;",document.querySelector(".c-icon").src="/weather-icons/"+l+".png",document.querySelector(".d-icon").style.display="none")}(o)))};document.querySelector(".save-btn").addEventListener("click",(()=>{event.preventDefault();const e=document.querySelector("#start-date").value,t=document.querySelector("#user-location").value,o=(new Date).toJSON().slice(0,10);""==t||""==e?alert("please enter a valid city and date!"):e<o?alert("Travel Date can not be before current time"):l(t)})),document.querySelector(".remove-btn").addEventListener("click",(()=>{document.querySelector(".Res-container").style.display="none"})),Client=t})();